version: '2.1'
rules:
  - id: 1
    name: rule1-basic-single-input
    tags:
      type: flow1
      category: category
    conditions:
      - operator: match_regex
        parameters:
          inputs:
            - address: rule1-input
          regex: rule1
  - id: 2
    name: rule2-basic-multiple-inputs
    tags:
      type: flow2
      category: category
    conditions:
      - operator: match_regex
        parameters:
          inputs:
            - address: rule2-input1
            - address: rule2-input2
          regex: rule2
  - id: 3
    name: rule3-basic-single-input-single-keypath
    tags:
      type: flow3
      category: category
    conditions:
      - operator: match_regex
        parameters:
          inputs:
            - address: rule3-input
              key_path:
                - keypath
          regex: rule3
  - id: 4
    name: rule4-basic-multiple-inputs-single-keypath
    tags:
      type: flow4
      category: category
    conditions:
      - operator: match_regex
        parameters:
          inputs:
            - address: rule4-input1
              key_path:
                - keypath
            - address: rule4-input2
              key_path:
                - keypath
          regex: rule4
  - id: 5
    name: rule5-basic-single-input-multiple-keypath
    tags:
      type: flow5
      category: category
    conditions:
      - operator: match_regex
        parameters:
          inputs:
            - address: rule5-input
              key_path:
                - keypath1
            - address: rule5-input
              key_path:
                - keypath2
          regex: rule5
  - id: 6
    name: rule6-multicondition-single-input
    tags:
      type: flow6
      category: category
    conditions:
      - operator: match_regex
        parameters:
          inputs:
            - address: rule6-input1
          regex: rule6
      - operator: phrase_match
        parameters:
          inputs:
            - address: rule6-input2
          list:
            - rule6
  - id: 7
    name: rule7-common-flow
    tags:
      type: flow7_8
      category: category
    conditions:
      - operator: match_regex
        parameters:
          inputs:
            - address: rule7-input
          regex: rule7
  - id: 8
    name: rule8-common-flow
    tags:
      type: flow7_8
      category: category
    conditions:
      - operator: match_regex
        parameters:
          inputs:
            - address: rule8-input
          regex: rule8
  - id: 9
    name: rule9-to-lower
    tags:
      type: flow9
      category: category
    conditions:
      - operator: match_regex
        parameters:
          inputs:
            - address: rule9-input
          regex: rule9
    transformers:
      - lowercase
  - id: 10
    name: rule10-keys-only
    tags:
      type: flow10
      category: category
    conditions:
      - operator: match_regex
        parameters:
          inputs:
            - address: rule10-input
          regex: rule10
    transformers:
      - keys_only
  - id: 11
    name: rule11-multicondition-multiple-input
    tags:
      type: flow11
      category: category
    conditions:
      - operator: match_regex
        parameters:
          inputs:
            - address: rule11-input1
            - address: rule11-input2
          regex: rule11_1
      - operator: phrase_match
        parameters:
          inputs:
            - address: rule11-input1
            - address: rule11-input2
          list:
            - rule11_2
  - id: 12
    name: rule12-keys-only-with-keypath
    tags:
      type: flow12
      category: category
    conditions:
      - operator: match_regex
        parameters:
          inputs:
            - address: rule12-input
              key_path:
                - rule12
          regex: rule12
    transformers:
      - keys_only
  - id: 13
    name: rule3-basic-single-input-single-multi-keypath
    tags:
      type: flow13
      category: category
    conditions:
      - operator: match_regex
        parameters:
          inputs:
            - address: rule13-input
              key_path:
                - first
                - second
                - last
          regex: rule13
  - id: 14
    name: rule14-keys-only-with-multi-keypath
    tags:
      type: flow14
      category: category
    conditions:
      - operator: match_regex
        parameters:
          inputs:
            - address: rule14-input
              key_path:
                - first
                - second
                - last
          regex: rule14
    transformers:
      - keys_only
  - id: 15
    name: rule15-remove-nulls-transformer
    tags:
      type: flow15
      category: category
    conditions:
      - operator: match_regex
        parameters:
          inputs:
            - address: rule15-input
          regex: rule15
    transformers:
      - removeNulls
  - id: 16
    name: rule16-ip-match
    tags:
      type: flow16
      category: category
    conditions:
      - operator: ip_match
        parameters:
          inputs:
            - address: rule16-input
          list:
            - "192.168.0.1"
            - "1.2.3.4"
            - "5.6.7.254"
            - "::ffff:0102:0304"
            - "1234:0:0:0:0:0:0:5678"
            - "::1"
            - "abcd::1234:5678:1234:5678"
            - "abcd::1234:0:0:0"
            - "abcd::1234:ffff:ffff:ffff"
            - "1.2.3.5"
            - "5.6.8.0"
            - "::ffff:0102:0305"
            - "5.6.8.0"
            - "::2"
            - "0:1234::5678"
            - "abcd:0:1233::"
  - id: 17
    name: rule17-ip-match
    tags:
      type: flow17
      category: category
    conditions:
      - operator: exact_match
        parameters:
          inputs:
            - address: rule17-input
          list:
            - "string"
            - "other"
            - "something else"
  - id: 18
    name: rule18-ip-match-with-cidr
    tags:
      type: flow18
      category: category
    conditions:
      - operator: ip_match
        parameters:
          inputs:
            - address: rule18-input
          list:
            - "192.188.0.0/16"
            - "abcd::1234:0:0:0/96"
  - id: 19
    name: rule19-on-match-actions
    tags:
      type: flow19
      category: category
    conditions:
      - operator: ip_match
        parameters:
          inputs:
            - address: rule19-input
          list:
            - "192.188.0.0/16"
            - "abcd::1234:0:0:0/96"
    on_match:
        - block_request
        - monitor
