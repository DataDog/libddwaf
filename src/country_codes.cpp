// Unless explicitly stated otherwise all files in this repository are
// dual-licensed under the Apache-2.0 License or BSD-3-Clause License.
//
// This product includes software developed at Datadog (https://www.datadoghq.com/).
// Copyright 2021 Datadog, Inc.

#include "country_codes.hpp"

#include <unordered_map>

namespace ddwaf {
namespace {
const std::unordered_map<std::string_view, uint8_t> country_codes{{"AD", 1}, {"AE", 2}, {"AF", 3},
    {"AG", 4}, {"AI", 5}, {"AL", 6}, {"AM", 7}, {"AO", 8}, {"AQ", 9}, {"AR", 10}, {"AS", 11},
    {"AT", 12}, {"AU", 13}, {"AW", 14}, {"AX", 15}, {"AZ", 16}, {"BA", 17}, {"BB", 18}, {"BD", 19},
    {"BE", 20}, {"BF", 21}, {"BG", 22}, {"BH", 23}, {"BI", 24}, {"BJ", 25}, {"BL", 26}, {"BM", 27},
    {"BN", 28}, {"BO", 29}, {"BQ", 30}, {"BR", 31}, {"BS", 32}, {"BT", 33}, {"BW", 34}, {"BY", 35},
    {"BZ", 36}, {"CA", 37}, {"CC", 38}, {"CD", 39}, {"CF", 40}, {"CG", 41}, {"CH", 42}, {"CI", 43},
    {"CK", 44}, {"CL", 45}, {"CM", 46}, {"CN", 47}, {"CO", 48}, {"CR", 49}, {"CU", 50}, {"CV", 51},
    {"CW", 52}, {"CX", 53}, {"CY", 54}, {"CZ", 55}, {"DE", 56}, {"DJ", 57}, {"DK", 58}, {"DM", 59},
    {"DO", 60}, {"DZ", 61}, {"EC", 62}, {"EE", 63}, {"EG", 64}, {"EH", 65}, {"ER", 66}, {"ES", 67},
    {"ET", 68}, {"FI", 69}, {"FJ", 70}, {"FK", 71}, {"FM", 72}, {"FO", 73}, {"FR", 74}, {"GA", 75},
    {"GB", 76}, {"GD", 77}, {"GE", 78}, {"GF", 79}, {"GG", 80}, {"GH", 81}, {"GI", 82}, {"GL", 83},
    {"GM", 84}, {"GN", 85}, {"GP", 86}, {"GQ", 87}, {"GR", 88}, {"GS", 89}, {"GT", 90}, {"GU", 91},
    {"GW", 92}, {"GY", 93}, {"HK", 94}, {"HN", 95}, {"HR", 96}, {"HT", 97}, {"HU", 98}, {"ID", 99},
    {"IE", 100}, {"IL", 101}, {"IM", 102}, {"IN", 103}, {"IQ", 104}, {"IR", 105}, {"IS", 106},
    {"IT", 107}, {"JE", 108}, {"JM", 109}, {"JO", 110}, {"JP", 111}, {"KE", 112}, {"KG", 113},
    {"KH", 114}, {"KI", 115}, {"KM", 116}, {"KN", 117}, {"KP", 118}, {"KR", 119}, {"KW", 120},
    {"KY", 121}, {"KZ", 122}, {"LA", 123}, {"LB", 124}, {"LC", 125}, {"LI", 126}, {"LK", 127},
    {"LR", 128}, {"LS", 129}, {"LT", 130}, {"LU", 131}, {"LV", 132}, {"LY", 133}, {"MA", 134},
    {"MC", 135}, {"MD", 136}, {"ME", 137}, {"MF", 138}, {"MG", 139}, {"MH", 140}, {"MK", 141},
    {"ML", 142}, {"MM", 143}, {"MN", 144}, {"MO", 145}, {"MP", 146}, {"MQ", 147}, {"MR", 148},
    {"MS", 149}, {"MT", 150}, {"MU", 151}, {"MV", 152}, {"MW", 153}, {"MX", 154}, {"MY", 155},
    {"MZ", 156}, {"NA", 157}, {"NC", 158}, {"NE", 159}, {"NF", 160}, {"NG", 161}, {"NI", 162},
    {"NL", 163}, {"NO", 164}, {"NP", 165}, {"NR", 166}, {"NU", 167}, {"NZ", 168}, {"OM", 169},
    {"PA", 170}, {"PE", 171}, {"PF", 172}, {"PG", 173}, {"PH", 174}, {"PK", 175}, {"PL", 176},
    {"PM", 177}, {"PN", 178}, {"PR", 179}, {"PS", 180}, {"PT", 181}, {"PW", 182}, {"PY", 183},
    {"QA", 184}, {"RE", 185}, {"RO", 186}, {"RS", 187}, {"RU", 188}, {"RW", 189}, {"SA", 190},
    {"SB", 191}, {"SC", 192}, {"SD", 193}, {"SE", 194}, {"SG", 195}, {"SH", 196}, {"SI", 197},
    {"SJ", 198}, {"SK", 199}, {"SL", 200}, {"SM", 201}, {"SN", 202}, {"SO", 203}, {"SR", 204},
    {"SS", 205}, {"ST", 206}, {"SV", 207}, {"SX", 208}, {"SY", 209}, {"SZ", 210}, {"TC", 211},
    {"TD", 212}, {"TF", 213}, {"TG", 214}, {"TH", 215}, {"TJ", 216}, {"TK", 217}, {"TL", 218},
    {"TM", 219}, {"TN", 220}, {"TO", 221}, {"TR", 222}, {"TT", 223}, {"TV", 224}, {"TW", 225},
    {"TZ", 226}, {"UA", 227}, {"UG", 228}, {"US", 229}, {"UY", 230}, {"UZ", 231}, {"VA", 232},
    {"VC", 233}, {"VE", 234}, {"VG", 235}, {"VI", 236}, {"VN", 237}, {"VU", 238}, {"WF", 239},
    {"WS", 240}, {"XK", 241}, {"YE", 242}, {"YT", 243}, {"ZA", 244}, {"ZM", 245}, {"ZW", 246}};

}

uint8_t country_code_to_index(std::string_view code)
{
    auto it = country_codes.find(code);
    if (it == country_codes.end()) {
        [[unlikely]] return 0;
    }
    return it->second;
}

} // namespace ddwaf
