version: "2.2"
metadata:
  rules_version: 1.8.0
rules:
  - id: rule1
    name: rule1
    tags:
      type: flow1
      category: category1
    conditions:
      - parameters:
          inputs:
            - address: server.request.body
          regex: (?:runtime|processbuilder)
          options:
            case_sensitive: true
            min_length: 5
        operator: match_regex
processors:
  - id: processor-001
    generator: extract_schema
    conditions:
      - operator: match_regex
        parameters:
          inputs:
            - address: waf.context.settings
              key_path:
                - extract-schema
          regex: ^true$
          options:
            case_sensitive: false
            min_length: 4
    parameters:
      mappings:
        - inputs:
            - address: server.request.body
          output: server.request.body.schema
    evaluate: false
    output: true
